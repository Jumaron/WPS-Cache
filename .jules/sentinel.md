## 2024-05-23 - Authenticated SSRF in Cache Preloader
**Vulnerability:** The Cache Preloader (`ToolsManager.php`, `CacheTools.php`, `CronManager.php`) used `wp_remote_get` with `sslverify => false` and did not validate the target URL. This allowed an authenticated administrator (or an attacker via CSRF/XSS, although nonces were present) to force the server to make HTTP requests to arbitrary internal or external URLs. This could be used to scan internal networks or access cloud metadata services.
**Learning:** Even when functionality is intended to "self-ping" (preload cache), assuming the URL is safe or that the server can access itself safely via public DNS is risky. `wp_remote_get` by default allows requests to local IPs unless filtered.
**Prevention:** Use `wp_safe_remote_get()` for any HTTP request where the URL might be influenced by user input or where safety from SSRF is required. This function blocks requests to private IP ranges and local network addresses. Also, never disable SSL verification (`sslverify => false`) in production code.
